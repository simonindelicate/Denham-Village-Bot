# A Chatbot Guide With Local Knowledge

A versatile chatbot powered by OpenAI's API, this serverless Netlify function utilizes keyword search and cosine similarity on embeddings to deliver contextually relevant responses, making it an ideal local guide or adaptable knowledgebase. Customize easily and generate embeddings with the companion repository.

## Key Features

- **OpenAI Integration**: Seamlessly integrates with OpenAI's API for intelligent responses.
- **Embeddings and Similarity**: Utilizes embeddings and cosine similarity for contextually relevant answers.
- **Serverless Netlify Function**: Runs as a serverless Netlify function for efficient deployment.
- **Customizable Knowledgebase**: Easily adapt to any knowledgebase with a set of embeddings.
- **Simple Frontend**: User-friendly and customizable frontend design in very simple html and css.
- **Customizable System Prompt**: Tailor the chatbot's responses to your specific requirements.
- **Contributor-Friendly**: Encourages contributions through clear guidelines.
- **MIT License**: Provides flexibility for usage and modification.

## About

I wanted to put together a basic chatbot that could use embeddings and answer relevant questions with the least fuss possible. The main things I wanted were: 
- For it to run as a serverless javascript function that I could host on Netlify without using Python etc.
- For it to use the bare minumum of straightforward html and css so that it was as easy as possible to customize.
- For it to return relevant information from poorly made embeddings. That is, I didn't want to spend ages making sure every chunk was perfect - I wanted a solution that would cope if you were to just split up a long text file that had been made for some other reason, get embeddings for it and chuck it into the functions folder. 

This bot does these things - the last one by using a hybrid approach of first doing a basic keyword search then by comparing embeddings to refine results before sending the query to the API. I recommend playing with this A LOT to tailor it to your use case.

This repo includes an embeddings file that contains a lot of information about Denham Village. It is not an efficient and well curated CSV - the results you get will improve if the CSV you replace it with is either of those things.

## Installation

### Prerequisites

- Node.js installed.
- An OpenAI API key (for chatbot functionality).
- Netlify CLI installed for local development.

### Setup

1. **Clone the Repository**
   \```bash
   git clone [repository URL]
   cd [repository folder]
   \```

2. **Install Dependencies**
   \```bash
   npm install
   \```

3. **Environment Configuration**
   Create a `.env` file in the root directory and add your OpenAI API key:
   \```env
   OPENAI_API_KEY=your_api_key_here
   \```
   If Deploying to Netlify or similar, you'll need to add your API key as an environment variable.
   
5. **Running the Application with Netlify Dev**
   \```bash
   netlify dev
   \```
   This will start the serverless function locally using Netlify Dev.

## Customization

To customize the chatbot's knowledge base:

1. **System Prompt**: Modify the `systemPrompt` variable in your JavaScript handler function.
2. **Embeddings File**: Replace `embeddings.csv` with your own file, matching the original format.
3. **BASICS Section**: Edit the `basics` variable in your JavaScript handler function.

To adjust bot responses:

You can customize the behavior and responses of the chatbot by adjusting the following parameters in the code:

1. **Temperature (`temperature`)

Temperature controls the randomness of the chatbot's responses. You can set the temperature to influence the creativity of the answers.

- A higher temperature (e.g., `0.8`) results in more random and creative responses.
- A lower temperature (e.g., `0.2`) produces more focused and deterministic answers.

Example:
const temperature = 0.5; // Adjust the temperature value as needed (e.g., 0.2 for more focused responses)

Experiment with different temperature values to achieve the desired response style.

2. Maximum Tokens (`max_tokens`)

The `max_tokens` parameter limits the length of the response generated by the chatbot. You can set `max_tokens` to control the response length.

Example:
const maxTokens = 2000; // Adjust the maximum token count as needed

Be cautious not to set it too low, as it may truncate responses. Finding the right value depends on your use case.

3. Number of Similar Chunks (`topNSimilarItems`)

You can adjust the number of similar chunks retrieved from the embeddings and presented to the chatbot. Changing this value affects the context considered when forming responses.

Example:
const topNSimilarItems = similarityScores.slice(0, 3); // Adjust the number of items as needed

Modify the number (e.g., from `3` to another value) to control how many similar chunks are considered for responses. Fewer chunks may lead to concise answers, while more chunks provide additional context.

Remember to test different parameter settings to fine-tune the chatbot's behavior according to your specific requirements.

- script.js also includes logic to convert urls into clickable links - you'll see I added an extra specific line to convert one particular site without a www. prefix - this is becasue the bot sometimes chooses to omit the prefix and I always wanted this link to work in the example use case.

## Deploying

You can deploy this chatbot on Netlify with ease. Here's how:

 -   Prerequisites:
        Ensure you have a Netlify account.

 -   Push to GitHub:
        Host your chatbot project on a GitHub repository.

  -  Connect Repository:
        Sign in to your Netlify account and create a new site from your GitHub repository.

-    Build Settings:
        Verify that your build settings are correctly configured. Netlify should detect serverless functions.

 -   Set Environment Variable:
        Add your OpenAI API key as an environment variable named OPENAI_API_KEY.

 -   Deploy:
        Click "Deploy Site" to initiate the deployment process.

 -   Access Your Chatbot:
        Once deployed, your chatbot will have a unique URL provided by Netlify.

  -  Testing:
        Visit the URL to test your chatbot's functionality.

 -   Custom Domain (Optional):
        If you have a custom domain, configure it in Netlify settings.

Other Serverless Options:

You can also deploy this chatbot on other serverless platforms, such as AWS Lambda or Vercel. To do so, you'll need to adapt the deployment process according to the platform's requirements and environment variable setup.

## Contributing

Interested in contributing? Follow these steps:

1. Fork the repository.
2. Create a new branch (`git checkout -b feature/YourFeature`).
3. Make changes.
4. Commit changes (`git commit -am 'Add some feature'`).
5. Push to the branch (`git push origin feature/YourFeature`).
6. Create a new Pull Request.

## License

MIT License - see the [LICENSE.md](LICENSE.md) file for details.

---

For more information, refer to the [documentation](link_to_documentation_if_available).

---

MIT License

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
